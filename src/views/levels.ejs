<%- include("partials/header") %>

<main class="container py-4">
  <% if (locals.success) { %>

  <div class="alert alert-success alert-dismissible fade show" role="alert">
    <%= success %>
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="alert"
      aria-label="Close"
    ></button>
  </div>
  <% } %> <% if (locals.error) { %>

  <div class="alert alert-danger alert-dismissible fade show" role="alert">
    <%= error %>
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="alert"
      aria-label="Close"
    ></button>
  </div>
  <% } %>

  <h1 class="my-3">Tous les niveaux</h1>

  <ul>
    <% for(const level of levels) { %>
    <li>
      <span class="badge bg-info p-3"><%= level.name %></span>
        <% if (locals.user.admin) { %>
         <a
        class="btn btn-outline-info py-0 px-1 ms-3 fs-6 text-decoration-none"
        href="/levels/<%= level.id %>/edit"
        >ÉDITER</a
      >

      <!-- Seules les 'method' GET & POST sont autorisées dans les FORM html. Du coup on ruse, même si les endpoints résultants ne sont pas très REST friendly -->
      <form
        class="d-inline"
        action="/levels/<%= level.id %>/delete"
        method="POST"
      >
        <input
          class="btn btn-outline-danger py-0 px-1 ms-3 fs-6"
          type="submit"
          value="SUPPRIMER"
        />
      </form>
        <% } %>
      
    </li>
    <% } %>
  </ul>
  <% if (locals.user.admin) { %>
   <h1 class="my-4">Ajouter un niveau</h1>

  <form class="mb-5" action="/levels" method="POST">
    <label class="form-label" for="name">Nom du niveau</label>
    <input class="form-control" type="text" name="name" id="name" required />
    <input
      class="btn btn-primary mt-3"
      type="submit"
      value="Ajouter le niveau"
    />
  </form>
  <% } %>
  
</main>

<%- include("partials/footer") %>
